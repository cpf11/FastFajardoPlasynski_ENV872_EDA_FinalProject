---
title: "Dall sheep reproductive success in Alaska and NW Canada"
author: 'Marisa Fajardo, Clara Fast, and Julia Plasynski '
output:
  pdf_document:
    keep_tex: yes
    fig_caption: yes
    number_sections: yes
  html_document:
    toc: true  
    df_print: paged
subtitle: https://github.com/cpf11/FastFajardoPlasynski_ENV872_EDA_FinalProject.git
geometry: margin=2.54cm
fontsize: 12pt
mainfont: Times New Roman
---

\newpage
\tableofcontents 
\newpage
\listoftables 
\newpage
\listoffigures 
\newpage

```{r setup, include=FALSE}
# Set your working directory
#getwd()

# Load your packages
require(lubridate)
require(tidyverse)
require(ggplot2)
require(dplyr)
require(knitr)
require(broom)

# Set your ggplot theme
mytheme <- theme_classic(base_size = 14) +
  theme(axis.text = element_text(color = "black"),
        legend.position = "top")
theme_set(mytheme)

# Load wrangled dataset
lamb_ewe <- read.csv("../Data/Processed/lamb_ewe_wrangle.csv")

#Change year to date class
lamb_ewe$year <- as.Date(as.character(lamb_ewe$year), format = "%Y")
```


# Rationale and Research Questions
Ungulate populations can easily fluctuate in response to changing environmental conditions (Koizumi and Derocher et al., 2019). Although dall sheep currently have stable population numbers, arctic and subarctic environments are subject to transformation due to changes in climatic conditions affecting snow cover, precipitation, and temperature (Higgins and Cassano, 2009). Changes in these conditions can affect resource availability and vegetation cover, influencing the success and reproductive abilities of herbivore populations (Post and Forchhaammer, 2007). Fluctuations in herbivore populations can result in a bottom up trophic cascade, further impacting community balance and carnivore population numbers (Kagata and Ohgushi, 2005).  Because of this, it is important to evaluate reproductive success in dall sheep to ensure stable populations of all organisms in arctic and subarctic North American ecosystems. Assessment of population health will allow conservation planning to take place as needed and will assist in predicting the future of the population as environmental conditions continue to change.

In this project, we will evaluate the effects of environmental conditions on dall sheep reproductive success using multiple linear regression. We aim to identify several factors of statistical significance to create an understanding of how fluctuating conditions will affect dall sheep in the future. We expect that decreased snow cover, decreased precipitation, and increased temperature will have a negative relationship with reproductive success. 


Question 1: How do environmental conditions affect Dall sheep reproductive success?

\newpage

# Dataset Information
This dataset consists of sheep population numbers from state and federal monitoring surveys throughout mountain ranges in Alaska and Northwestern Canada during the years 2000-2015. The climate and environmental data were estimated for the fourteen mountain ranges where the sheep were located. Daily snow was estimated using MODIS imagery, and distance to the center of the sheep range, as well as latitude, longitude, and elevation were gathered from the Global Multi-resolution Terrain Elevation Data 2010. Additionally, monthly gridded climate products from the Scenarios Network for Alaska + Arctic Planning (SNAP), were used to estimate average annual temperature, average May temperature, total annual precipitation, and total winter (October-April) precipitation. The surveys were mostly carried out during the summer using aircraft. As raw sheep counts could not be compared between surveys due to differences in methods, locations, and areas, the variable, Lamb-to-ewe ratio, was calculated, serving as an indicator of recruitment. The dataset therefore contains estimated annual average Dall sheep lamb-to-ewe ratios from each year between 2000-2015. 



\newpage

# Exploratory Analysis 

```{r echo=FALSE}
#### Explore the data

#Creating Summary Table for Lamb Data
total_summary_lamb<-describe(lamb_ewe, fast = TRUE)
knitr::kable(total_summary_lamb, caption = "Summary Statistics of Lamb Dataset")

#Creating Smaller Summary Table for Lamb EWE Ratio
summary_lambratio <- lamb_ewe %>%
  summarise(mean.ratio=mean(lamb_ewe_ratio), minimum.ratio=min(lamb_ewe_ratio), maximum.ratio=max(lamb_ewe_ratio), sd.ratio=sd(lamb_ewe_ratio))

knitr::kable(summary_lambratio, caption = "Lamb EWE Ratio: Summary Table")
```

```{r fig.cap="Scatterplot matrix of dataset", echo = FALSE}
#Plot scatterplot matrix 
plot(lamb_ewe)
```


```{r fig.cap="Lamb EWE Ratio over Time", echo = FALSE}
#Generate plot of lamb EWE ratio against time 
explorelambewe<-ggplot(lamb_ewe, aes(x = year, y = lamb_ewe_ratio)) +
  geom_point() +
  labs(x="Time", y = "Lamb EWE Ratio")

plot(explorelambewe)
```

```{r fig.cap="Histogram of Lamb EWE Ratio", echo = FALSE}
#Generate histogram of lamb EWE ratio
ggplot(data = lamb_ewe) +
  geom_histogram(mapping = aes(x = lamb_ewe_ratio), binwidth = 0.1, fill="darkblue") +
labs(x="Lamb EWE Ratio")
```


\newpage

# Analysis

```{r include = FALSE}
#Create preliminary GLM 
lamb_lm <- lm(data = lamb_ewe, lamb_ewe_ratio ~ year + elevation + snow_line_elevation + 
              snow_disappearance + snow_cover_duration + temp + precip + may_temp + winter_precip)

#Summarize model 
summary(lamb_lm)

#Choose best model by AIC in a Stepwise Algorithm
step(lamb_lm)

#Best model selected based off previous step 
new_lamb_lm<-lm(formula = lamb_ewe_ratio ~ snow_cover_duration + temp + may_temp, 
    data = lamb_ewe)

#Summarize model 
summary(new_lamb_lm)
```

```{r echo = FALSE}
#Generate summary table of regression results 
lm(formula = lamb_ewe_ratio ~ snow_cover_duration + temp + may_temp, 
   data = lamb_ewe) %>%
  tidy() %>%
  kable(caption = "Linear Regression Results")
```

```{r echo = FALSE, fig.cap="Relationship between lamb ewe ratio and snow cover duration"}
#Plot relationship between lamb ewe ratio and snow cover duration
lamb_snowcoverduration<-ggplot(lamb_ewe, aes(x = snow_cover_duration, y = lamb_ewe_ratio)) +
  geom_point() +
  geom_smooth(method=lm, se=FALSE) +
  labs(x="Snow Cover Duration", y = "Lamb EWE Ratio")
plot(lamb_snowcoverduration)
```

```{r echo=FALSE, fig.cap="Relationship between lamb ewe ratio and temperature (Cº)"}
#Plot relationship between lamb ewe ratio and temperature
lamb_temp<-ggplot(lamb_ewe, aes(x = temp, y = lamb_ewe_ratio)) +
  geom_point() +
  geom_smooth(method=lm, se=FALSE, col="red") +
  labs(x="Temperature (Cº)", y = "Lamb EWE Ratio")
plot(lamb_temp)
```

```{r echo=FALSE, fig.cap="Relationship between lamb ewe ratio and may temperature (Cº)"}
#Plot relationship between lamb ewe ratio and may temperature
lamb_maytemp<-ggplot(lamb_ewe, aes(x = may_temp, y = lamb_ewe_ratio)) +
  geom_point() +
  geom_smooth(method=lm, se=FALSE, col="green") +
  labs(x="May Temperature (Cº)", y = "Lamb EWE Ratio")
plot(lamb_maytemp)
```

```{r fig.cap="Diagnostic plots of final model", echo = FALSE}
#Diagnostic Plots 
par(mfrow = c(2, 2))
plot(new_lamb_lm)
```


\newpage

# Summary and Conclusions

In summary, we found that some climatic conditions have a significant effect on dall sheep reproductive success. Our results indicate that reproductive success is reduced when overall temperatures are high, likely due to adaptations of arctic species to thrive in colder conditions with higher snow cover. This aligns with our findings that reproductive success increases when snow cover duration is longer, indicating again that colder overall temperatures benefit reproductive success of dall sheep. Reproductive success also increased in response to higher May temperature, indicating the importance of seasonal temperature variation for population success. Survivability of offspring likely depends heavily on seasonal vegetation, therefore high temperatures in isolated months such as May are an important factor in maintaining population stability. 

Our results provide significant implications for future population management. Arctic environments are experiencing increasing temperatures at substantially higher rates than other areas, a trend that will also contribute to decreased snow cover in Arctic North America (Corell, 2006). As climate change continues to affect environmental conditions, we can expect dall sheep populations to decline in the future due to evidence that increased temperatures and shorter snow cover duration negatively impacts reproductive success. Because of this, it is essential to form population management plans immediately to account for the expected population decline and subsequent trophic cascade. Management plans can include protected natural areas for these populations, potentially at higher elevations and latitudes to accommodate for migration to colder areas as temperatures rise. 

# Future Recommendations

For future research and analysis, more statistical tests should be completed to look for interactions between variables. Additionally, more data could be used in conjunction with this dataset to further analyze our research question. Data on the rate of temperature and snow cover duration change in Arctic North America can be used in conjunction with this data set to estimate how heavily dall sheep reproductive success will be affected in the future. 

\newpage

# References

Corell, R. W. (2006). Challenges of climate change: An arctic perspective. AMBIO: A Journal of the Human Environment, 35(4), 148–152. https://doi.org/10.1579/0044-7447(2006)35[148:coccaa]2.0.co;2 

Higgins, M. E., & Cassano, J. J. (2009). Impacts of reduced sea ice on winter Arctic atmospheric circulation, precipitation, and temperature. J. Geophys. Res., 114, D16107. doi:10.1029/2009JD011884

Kagata, H., & Ohgushi, T. (2005). Bottom-up trophic cascades and material transfer in Terrestrial Food Webs. Ecological Research, 21(1), 26–34. https://doi.org/10.1007/s11284-005-0124-z 

Lambert Koizumi, C., & Derocher, A. E. (2019). Predation risk and space use of a declining dall sheep (ovis dalli dalli) population. PLOS ONE, 14(4). https://doi.org/10.1371/journal.pone.0215519 

Post, E., & Forchhammer, M. C. (2007). Climate change reduces reproductive success of an Arctic herbivore through trophic mismatch. Phil. Trans. R. Soc. B, 363(1501), 2367–2373. doi:10.1098/rstb.2007.2207 
